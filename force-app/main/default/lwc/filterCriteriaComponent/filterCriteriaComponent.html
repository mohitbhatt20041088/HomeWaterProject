<template>
  <!-- Filter Screen -->
  <template if:true={showFilterScreen}>
    <lightning-card variant="base">
      <div class="form-container">
        
        <!-- Billing Type Section -->
        <div class="question-section">
          <h2 class="question-title">Billing Type</h2>
          <p class="question-subtitle">Please select your preferred billing type</p>
          
          <div class="pill-button-group">
            <template for:each={billingPicklistOptions} for:item="option">
              <button 
                key={option.value}
                class={option.cssClass}
                data-value={option.value}
                data-field="billingType"
                onclick={handlePicklistChange}
                aria-label={option.label}
                title={option.label}>
                {option.label}
              </button>
            </template>
          </div>
        </div>
        
        <!-- Family Type Section -->
        <div class="question-section">
          <h2 class="question-title">Product Family</h2>
          <p class="question-subtitle">Please select the product family</p>
          
          <div class="pill-button-group">
            <template for:each={familyPicklistOptions} for:item="option">
              <button 
                key={option.value}
                class={option.cssClass}
                data-value={option.value}
                data-field="familyType"
                onclick={handlePicklistChange}
                aria-label={option.label}
                title={option.label}>
                {option.label}
              </button>
            </template>
          </div>
        </div>
        
        <!-- Stage Type Section -->
        <div class="question-section">
          <h2 class="question-title">Stage Type</h2>
          <p class="question-subtitle">Please select the stage type</p>
          
          <div class="pill-button-group">
            <template for:each={stagePicklistOptions} for:item="option">
              <button 
                key={option.value}
                class={option.cssClass}
                data-value={option.value}
                data-field="stageType"
                onclick={handlePicklistChange}
                aria-label={option.label}
                title={option.label}>
                {option.label}
              </button>
            </template>
          </div>
        </div>
        
        <!-- Preferred Block Section -->
        <div class="question-section">
          <h2 class="question-title">Preferred Block</h2>
          <p class="question-subtitle">Please select your preferred block</p>
          
          <div class="pill-button-group">
            <template for:each={preferredBlockPicklistOptions} for:item="option">
              <button 
                key={option.value}
                class={option.cssClass}
                data-value={option.value}
                data-field="preferredBlockType"
                onclick={handlePicklistChange}
                aria-label={option.label}
                title={option.label}>
                {option.label}
              </button>
            </template>
          </div>
        </div>
        
      </div>
      
      <!-- Navigation Buttons -->
      <div slot="footer" class="button-container slds-m-top_medium slds-align_absolute-center ">
        <lightning-button label="Back" variant="neutral" onclick={handleBackToZip}></lightning-button>
        <lightning-button label="Filter Products" variant="brand" onclick={handleFindProducts}></lightning-button>
      </div>
    </lightning-card>
  </template>

  <!-- Product Table Screen -->
  <template if:true={showTableScreen}>
    <c-filter-product-table-component zip-code={zipCode} filtered-products={filteredProductsData}
      selected-product-term={selectedProductTerm} onnavigate={handleNavigation}>
    </c-filter-product-table-component>
  </template>

  <!-- Product Terms Screen -->
  <template if:true={showTermScreen}>
    <c-product-term-component 
      base-price={selectedProductTotalPrice}
      onmainoption={handleMainOptionChange}
      onproductterm={handleProductTermChange}
      onaddtocart={handleAddToCart}
      onnavigate={handleNavigation}>
    </c-product-term-component>
  </template>

  <!-- Product Detail Screen -->
  <template if:true={showDetailScreen}>
    <c-product-detail-page-component 
        zip-code={zipCode} 
        selected-products={selectedProductsData}
        selected-product-term={selectedProductTerm}
        selected-main-option={selectedMainOption}
        selected-billing-type={selectedBillingType}
        selected-family-type={selectedFamilyType}
        selected-stage-type={selectedStageType}
        selected-preferred-block-type={selectedPreferredBlockType}
        onnavigate={handleNavigation}>
    </c-product-detail-page-component>
  </template>

  <!-- User Detail Screen -->
  <template if:true={showUserDetailScreen}>
    <c-use-detail-page-component zip-code={zipCode} selected-products={selectedProductsData}
      selected-product-term={selectedProductTerm} onnavigate={handleNavigation}>
    </c-use-detail-page-component>
  </template>
</template>